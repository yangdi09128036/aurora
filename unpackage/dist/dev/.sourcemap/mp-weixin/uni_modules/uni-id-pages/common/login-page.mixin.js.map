{"version":3,"file":"login-page.mixin.js","sources":["uni_modules/uni-id-pages/common/login-page.mixin.js"],"sourcesContent":["import {\r\n\tmutations\r\n} from '@/uni_modules/uni-id-pages/common/store.js'\r\nimport config from '@/uni_modules/uni-id-pages/config.js'\r\nconst mixin = {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tconfig,\r\n\t\t\tuniIdRedirectUrl: '',\r\n\t\t\tisMounted: false\r\n\t\t}\r\n\t},\r\n\tonUnload() {\r\n\t\t// #ifdef H5\r\n\t\tdocument.onkeydown = false\r\n\t\t// #endif\r\n\t},\r\n\tmounted() {\r\n\t\tthis.isMounted = true\r\n\t},\r\n\tonLoad(e) {\r\n\t\tif (e.is_weixin_redirect) {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\tmask: true\r\n\t\t\t})\r\n\r\n\t\t\tif (window.location.href.includes('#')) {\r\n\t\t\t\t// 将url通过 ? 分割获取后面的参数字符串 再通过 & 将每一个参数单独分割出来\r\n\t\t\t\tconst paramsArr = window.location.href.split('?')[1].split('&')\r\n\t\t\t\tparamsArr.forEach(item => {\r\n\t\t\t\t\tconst arr = item.split('=')\r\n\t\t\t\t\tif (arr[0] == 'code') {\r\n\t\t\t\t\t\te.code = arr[1]\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tthis.$nextTick(n => {\r\n\t\t\t\t// console.log(this.$refs.uniFabLogin);\r\n\t\t\t\tthis.$refs.uniFabLogin.login({\r\n\t\t\t\t\tcode: e.code\r\n\t\t\t\t}, 'weixin')\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (e.uniIdRedirectUrl) {\r\n\t\t\tthis.uniIdRedirectUrl = decodeURIComponent(e.uniIdRedirectUrl)\r\n\t\t}\r\n\r\n\t\t// #ifdef MP-WEIXIN\r\n\t\tif (getCurrentPages().length === 1) {\r\n\t\t\tuni.hideHomeButton()\r\n\t\t\tconsole.log('已隐藏：返回首页按钮');\r\n\t\t}\r\n\t\t// #endif\r\n\t},\r\n\tcomputed: {\r\n\t\tneedAgreements() {\r\n\t\t\tif (this.isMounted) {\r\n\t\t\t\tif (this.$refs.agreements) {\r\n\t\t\t\t\treturn this.$refs.agreements.needAgreements\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tagree: {\r\n\t\t\tget() {\r\n\t\t\t\tif (this.isMounted) {\r\n\t\t\t\t\tif (this.$refs.agreements) {\r\n\t\t\t\t\t\treturn this.$refs.agreements.isAgree\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tset(agree) {\r\n\t\t\t\tif (this.$refs.agreements) {\r\n\t\t\t\t\tthis.$refs.agreements.isAgree = agree\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('不存在 隐私政策协议组件');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tloginSuccess(e) {\r\n\t\t\tmutations.loginSuccess({\r\n\t\t\t\t...e,\r\n\t\t\t\tuniIdRedirectUrl: this.uniIdRedirectUrl\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default mixin\n"],"names":["config","uni","mutations"],"mappings":";;;;AAIK,MAAC,QAAQ;AAAA,EACb,OAAO;AACN,WAAO;AAAA,MACT,QAAGA,8BAAM;AAAA,MACN,kBAAkB;AAAA,MAClB,WAAW;AAAA,IACX;AAAA,EACD;AAAA,EACD,WAAW;AAAA,EAIV;AAAA,EACD,UAAU;AACT,SAAK,YAAY;AAAA,EACjB;AAAA,EACD,OAAO,GAAG;AACT,QAAI,EAAE,oBAAoB;AACzBC,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,MACV,CAAI;AAED,UAAI,OAAO,SAAS,KAAK,SAAS,GAAG,GAAG;AAEvC,cAAM,YAAY,OAAO,SAAS,KAAK,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG;AAC9D,kBAAU,QAAQ,UAAQ;AACzB,gBAAM,MAAM,KAAK,MAAM,GAAG;AAC1B,cAAI,IAAI,CAAC,KAAK,QAAQ;AACrB,cAAE,OAAO,IAAI,CAAC;AAAA,UACd;AAAA,QACN,CAAK;AAAA,MACD;AACD,WAAK,UAAU,OAAK;AAEnB,aAAK,MAAM,YAAY,MAAM;AAAA,UAC5B,MAAM,EAAE;AAAA,QACR,GAAE,QAAQ;AAAA,MACf,CAAI;AAAA,IACD;AAED,QAAI,EAAE,kBAAkB;AACvB,WAAK,mBAAmB,mBAAmB,EAAE,gBAAgB;AAAA,IAC7D;AAGD,QAAI,gBAAe,EAAG,WAAW,GAAG;AACnCA,oBAAAA,MAAI,eAAgB;AACpBA,oBAAAA,MAAA,MAAA,OAAA,6DAAY,YAAY;AAAA,IACxB;AAAA,EAED;AAAA,EACD,UAAU;AAAA,IACT,iBAAiB;AAChB,UAAI,KAAK,WAAW;AACnB,YAAI,KAAK,MAAM,YAAY;AAC1B,iBAAO,KAAK,MAAM,WAAW;AAAA,QAClC,OAAW;AACN,iBAAO;AAAA,QACP;AAAA,MACD;AAAA,IACD;AAAA,IACD,OAAO;AAAA,MACN,MAAM;AACL,YAAI,KAAK,WAAW;AACnB,cAAI,KAAK,MAAM,YAAY;AAC1B,mBAAO,KAAK,MAAM,WAAW;AAAA,UACnC,OAAY;AACN,mBAAO;AAAA,UACP;AAAA,QACD;AAAA,MACD;AAAA,MACD,IAAI,OAAO;AACV,YAAI,KAAK,MAAM,YAAY;AAC1B,eAAK,MAAM,WAAW,UAAU;AAAA,QACrC,OAAW;AACNA,wBAAAA,gFAAY,cAAc;AAAA,QAC1B;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACR,aAAa,GAAG;AACfC,0CAAAA,UAAU,aAAa;AAAA,QACtB,GAAG;AAAA,QACH,kBAAkB,KAAK;AAAA,MAC3B,CAAI;AAAA,IACD;AAAA,EACD;AACF;;"}